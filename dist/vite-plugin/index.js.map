{"version":3,"file":"index.js","sources":["../../src/vite-plugin/index.js"],"sourcesContent":["/**\n * aartisan - Vite plugin\n * \n * Provides build-time optimizations and transformations for AI agent understanding.\n */\nimport { createFilter } from '@rollup/pluginutils';\nimport { transformJSX, generateMetadata } from './transforms.js';\n\n/**\n * Default plugin options\n * @type {Object}\n */\nconst defaultOptions = {\n  include: ['**/*.jsx', '**/*.tsx'],\n  exclude: ['node_modules/**'],\n  optimizationLevel: 'standard', // 'basic', 'standard', 'advanced'\n  accessibilityFeatures: true,\n  culturalContexts: ['global'],\n  injectMetadata: true,\n  verbose: false\n};\n\n/**\n * Creates an aartisan Vite plugin\n * @param {Object} options - Plugin options\n * @returns {Object} Vite plugin\n */\nexport default function aartisanPlugin(options = {}) {\n  const resolvedOptions = {\n    ...defaultOptions,\n    ...options\n  };\n  \n  // Create filter for file processing\n  const filter = createFilter(\n    resolvedOptions.include,\n    resolvedOptions.exclude\n  );\n  \n  // Metadata cache for components\n  const metadataCache = new Map();\n  \n  return {\n    name: 'aartisan-vite-plugin',\n    \n    // Configuration hook\n    config(config) {\n      if (resolvedOptions.verbose) {\n        console.log('[Aartisan] Plugin initialized with options:', resolvedOptions);\n      }\n      \n      return config;\n    },\n    \n    // Transform hook for JSX files\n    async transform(code, id) {\n      // Skip if file doesn't match filter\n      if (!filter(id)) {\n        return null;\n      }\n      \n      // Skip if not a JSX/TSX file\n      if (!id.endsWith('.jsx') && !id.endsWith('.tsx')) {\n        return null;\n      }\n      \n      try {\n        // Transform JSX with aartisan enhancements\n        const result = await transformJSX(code, id, resolvedOptions);\n        \n        // Store metadata in cache\n        if (result.metadata && result.metadata.length > 0) {\n          metadataCache.set(id, result.metadata);\n        }\n        \n        if (resolvedOptions.verbose) {\n          console.log(`[Aartisan] Transformed ${id} (${result.metadata?.length || 0} components found)`);\n        }\n        \n        return {\n          code: result.code,\n          map: result.map\n        };\n      } catch (error) {\n        // Log error but don't break the build\n        console.error(`[Aartisan] Error transforming ${id}:`, error);\n        return null;\n      }\n    },\n    \n    // Build hook to generate metadata\n    async buildEnd() {\n      if (resolvedOptions.injectMetadata && metadataCache.size > 0) {\n        if (resolvedOptions.verbose) {\n          console.log(`[Aartisan] Generating metadata for ${metadataCache.size} files`);\n        }\n        \n        // Generate metadata file\n        try {\n          await generateMetadata(metadataCache, resolvedOptions);\n        } catch (error) {\n          console.error('[Aartisan] Error generating metadata:', error);\n        }\n      }\n    }\n  };\n}"],"names":["defaultOptions","include","exclude","optimizationLevel","accessibilityFeatures","culturalContexts","injectMetadata","verbose","aartisanPlugin","options","resolvedOptions","filter","createFilter","metadataCache","Map","name","config","console","log","transform","code","id","endsWith","result","transformJSX","metadata","length","set","map","error","buildEnd","size","generateMetadata"],"mappings":"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"}